I am totally rewriting this bastard.